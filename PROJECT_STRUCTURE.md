# Project Structure

This document describes the structure of the DISA STIG compliance project for CentOS 10 Stream.

## Directory Structure

```
centos10disastig/
├── ansible.cfg              # Ansible configuration with STIG XML callback
├── inventory.yml            # Ansible inventory file (configure with your hosts)
├── playbook.yml             # Main playbook that applies DISA STIG
├── site.yml                 # Wrapper playbook for compatibility
├── requirements.yml         # Ansible Galaxy requirements (minimal - role is local)
│
├── callback_plugins/        # Ansible callback plugins
│   └── stig_xml.py         # STIG XML report generator
│
├── roles/                   # Ansible roles directory
│   └── rhel9STIG/          # Official DISA RHEL 9 STIG role
│       ├── defaults/
│       │   └── main.yml    # STIG rule configuration (973+ rules)
│       ├── tasks/
│       │   └── main.yml    # STIG implementation tasks (2966 lines)
│       ├── handlers/
│       │   └── main.yml    # Service restart handlers
│       ├── files/
│       │   └── U_RHEL_9_STIG_V2R6_Manual-xccdf.xml  # STIG definition file
│       └── callback_plugins/
│           └── stig_xml.py # Callback plugin (duplicate of root)
│
├── group_vars/              # Group variables (optional customization)
│   └── all.yml.example     # Example group variables
│
├── Scripts/
│   ├── enforce.sh           # Linux/Mac enforcement script
│   ├── apply-stig.sh        # Linux/Mac helper script
│   ├── apply-stig-openscap.sh  # OpenSCAP alternative script
│   └── validate-stig.sh     # Validation script
│
└── Documentation/
    ├── README.md            # Main documentation
    ├── QUICKSTART.md        # Quick start guide
    └── PROJECT_STRUCTURE.md # This file
```

## Key Files

### ansible.cfg
- Configures Ansible to use the STIG XML callback plugin
- Sets up privilege escalation
- Configures callback plugin path

### playbook.yml
- Main playbook that applies DISA STIG V2R6
- Uses the `rhel9STIG` role
- Includes pre-tasks to verify OS version

### roles/rhel9STIG/defaults/main.yml
- Contains all STIG rule configuration variables
- Each rule has a `rhel9STIG_stigrule_XXXXX_Manage` variable
- Set to `True` to enable, `False` to disable
- Contains 973+ STIG rules

### roles/rhel9STIG/tasks/main.yml
- Implements all STIG rules
- 2966 lines of Ansible tasks
- Each task corresponds to a DISA STIG requirement

### inventory.yml
- Define your CentOS 10 Stream hosts here
- Configure SSH access and credentials

## STIG Rule Format

Each STIG rule follows this pattern:
```yaml
# R-257779 RHEL-09-211020
rhel9STIG_stigrule_257779_Manage: True
rhel9STIG_stigrule_257779__etc_issue_Dest: /etc/issue
rhel9STIG_stigrule_257779__etc_issue_Content: '...'
```

- `rhel9STIG_stigrule_XXXXX_Manage`: Enable/disable the rule
- Additional variables: Rule-specific configuration

## Customization

1. **Disable specific STIG rules**: Edit `roles/rhel9STIG/defaults/main.yml`
2. **Add group variables**: Create `group_vars/all.yml` (see example)
3. **Modify inventory**: Edit `inventory.yml` with your hosts

## Output

- **XML Compliance Report**: Generated by callback plugin (location shown during execution)
- **Ansible Log**: `ansible.log` (if logging enabled)
- **Console Output**: Shows task execution and results

## Notes

- The role is currently using RHEL 9 STIG but works with CentOS 10 Stream
- When RHEL 10 STIG becomes available, update the role directory from `rhel9STIG` to `rhel10STIG`
- All STIG rules are enabled by default
- Some rules may require system reboot
- Review changes before applying to production

